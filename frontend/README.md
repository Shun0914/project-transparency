# Frontend - Project Transparency

プロジェクトの透明性を可視化する%スコアリングシステムのフロントエンド

## 技術スタック

- **Next.js 14**: App Router使用
- **TypeScript**: 型安全性
- **Tailwind CSS**: スタイリング
- **Recharts**: グラフ描画
- **axios**: HTTP client（リクエストインターセプター使用）
- **JWT**: トークンベース認証
- **LocalStorage**: トークン保存

## セットアップ

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 環境変数の設定

`.env.local`ファイルを作成し、APIのベースURLを設定します：

```bash
cp .env.local.example .env.local
```

`.env.local`:
```
NEXT_PUBLIC_API_BASE_URL=http://localhost:8000/api
```

### 3. 開発サーバーの起動

```bash
npm run dev
```

アプリケーションは `http://localhost:3000` で起動します。

## プロジェクト構造

```
frontend/
├── src/
│   ├── app/
│   │   ├── layout.tsx              # ルートレイアウト
│   │   ├── page.tsx                # プロジェクト一覧ページ（要認証）
│   │   ├── globals.css             # グローバルスタイル
│   │   ├── auth/
│   │   │   ├── login/
│   │   │   │   └── page.tsx        # ログインページ
│   │   │   └── register/
│   │   │       └── page.tsx        # 新規登録ページ
│   │   └── projects/
│   │       └── [id]/
│   │           ├── page.tsx        # ダッシュボードページ（要認証）
│   │           └── scoring/
│   │               └── page.tsx    # スコアリングページ（要認証）
│   ├── components/
│   │   ├── ProjectCard.tsx         # プロジェクトカード
│   │   ├── Dashboard.tsx           # ダッシュボード
│   │   ├── ScoreChart.tsx          # スコアグラフ
│   │   ├── AuthGuard.tsx           # 認証ガード（未ログイン時リダイレクト）
│   │   └── Header.tsx              # ヘッダー（ログアウトボタン含む）
│   └── lib/
│       ├── api.ts                  # APIクライアント（axiosインターセプター）
│       ├── auth.ts                 # 認証ヘルパー（トークン管理、認証API）
│       └── types.ts                # 型定義
├── .env.local                      # 環境変数（API URL）
├── package.json
├── tsconfig.json
├── tailwind.config.js
├── next.config.js
└── README.md
```

## 主な機能

### 1. 認証機能

- **ユーザー登録**: メールアドレス、パスワード、名前で新規登録
- **ログイン**: 既存ユーザーのログイン
- **自動ログイン**: LocalStorageのトークンで自動ログイン維持
- **ログアウト**: トークン削除とログインページへリダイレクト
- **認証ガード**: 未ログイン時は自動的にログインページへ遷移
- **401エラー自動処理**: トークン無効時の自動ログアウト

### 2. プロジェクト一覧（要認証）

- 自分のプロジェクトの一覧表示
- プロジェクトの作成
- プロジェクト詳細への遷移

### 3. ダッシュボード（要認証）

- 加重平均スコアの表示
- メンバー別スコア一覧
- スコア推移グラフ
- メンバー追加機能

### 4. スコアリング（要認証）

- メンバーごとのスコア入力
- スライダーUIでの直感的な入力
- コメント追加機能
- リアルタイムでのダッシュボード更新

## ページ構成

### ログインページ (`/auth/login`)

- メールアドレスとパスワードでログイン
- 新規登録ページへのリンク
- ログイン成功時、プロジェクト一覧へリダイレクト

### 新規登録ページ (`/auth/register`)

- メールアドレス、パスワード、名前で新規登録
- ログインページへのリンク
- 登録成功時、プロジェクト一覧へリダイレクト

### プロジェクト一覧 (`/`) **※要認証**

- 自分のプロジェクトの一覧表示
- 新規プロジェクト作成フォーム
- ヘッダーにログアウトボタン

### プロジェクトダッシュボード (`/projects/[id]`) **※要認証**

- 加重平均スコアの表示
- メンバー別スコア一覧
- スコア推移グラフ
- メンバー追加機能
- スコア入力ページへのリンク

### スコアリングページ (`/projects/[id]/scoring`) **※要認証**

- メンバーごとのスコア入力フォーム
- 0-100のスライダー入力
- コメント入力欄

## 認証フロー

### 初回アクセス時

1. アプリケーションにアクセス
2. `AuthGuard`がトークンの有無をチェック
3. トークンがない場合、`/auth/login`にリダイレクト
4. ログインまたは新規登録を実行
5. トークンをLocalStorageに保存
6. プロジェクト一覧ページへリダイレクト

### ログイン維持

- LocalStorageにトークンが保存されている場合、自動的にログイン状態を維持
- トークン有効期限は24時間
- ページリロード時もログイン状態を維持

### APIリクエスト時

1. `axios`インターセプターが自動的にAuthorizationヘッダーを追加
   ```
   Authorization: Bearer <token>
   ```
2. バックエンドでトークン検証
3. 401エラー発生時、自動的にログアウトしてログインページへリダイレクト

### ログアウト

1. ヘッダーの「ログアウト」ボタンをクリック
2. LocalStorageからトークンを削除
3. `/auth/login`にリダイレクト

## UI/UXの特徴

- **レスポンシブデザイン**: モバイル・タブレット・デスクトップに対応
- **直感的な操作**: 説明なしで使えるシンプルなUI
- **リアルタイム更新**: スコア入力後、即座にダッシュボードに反映
- **視覚的なフィードバック**: ローディング状態とエラー表示
- **シームレスな認証**: 未ログイン時の自動リダイレクト、401エラーの自動処理

## ビルド

```bash
npm run build
```

本番用のビルドを作成します。

## 本番環境での起動

```bash
npm start
```

ビルド後のアプリケーションを起動します。
